(function(e){"use strict";function a(e,a,t){window.top.postMessage({slug:"wpcp",action:"wpcp-change-value",id:e,value:a,old_value:t},window.location.origin)}function t(e){if(e.origin!==window.parent.location.origin)return;if("object"!=typeof e.data||null===e.data||void 0===e.data.action)return;if("wpcp-select-entries"!==e.data.action)return;if("shareonedrive"!==e.data.slug)return;const a=e.data.entries[0];i.find(".wpcp-folder-selector-current").val(a.entry_name),i.find(".wpcp-folder-selector-input-account").val(a.account_id).trigger("change"),i.find(".wpcp-folder-selector-input-drive").val(a.drive_id).trigger("change"),i.find(".wpcp-folder-selector-input-id").val(a.entry_id).trigger("change"),i.find(".wpcp-folder-selector-input-name ").val(a.entry_name).trigger("change"),window.modal_folder_selector.close(),window.removeEventListener("message",t)}function n(a){if(e("#shareonedrive-modal-folder-selector").length>0)return window.modal_folder_selector.open();var t=e('<a tabindex="0" class="close-button" title="" onclick="modal_folder_selector.close();"><i class="eva eva-close eva-lg" aria-hidden="true"></i></a></div>'),n=e('<div class="shareonedrive-modal-body" tabindex="0"></div>'),o=e('<div class="shareonedrive-modal-footer"><div class="shareonedrive-modal-buttons"></div></div>'),i=e('<div id="shareonedrive-modal-folder-selector" class="ShareoneDrive shareonedrive-modal shareonedrive-modal80 light"><div class="modal-dialog"><div class="modal-content"></div></div></div>'),d=a.clone().show();d.find(".wpcp-module").ShareoneDrive(ShareoneDrive_vars),n.append(d),e("#wpcp").append(i),e("#shareonedrive-modal-folder-selector .modal-content").append(t,n,o);var c=new RModal(document.getElementById("shareonedrive-modal-folder-selector"),{bodyClass:"rmodal-open",dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0,afterClose(){window.removeEventListener("message",self.callback_handler)}});document.addEventListener("keydown",function(e){c.keydown(e)},!1),c.open(),window.modal_folder_selector=c}var o=null,i=null;/shareonedrive/i.test(window.location.href)&&e("body").addClass("wpcp-admin"),e("#wpcp").fadeIn(),e("#wpcp").on({click:function(a){var t=e(this),n=t.data("nav-tab");if(t.hasClass("disabled"))return!1;e("a[data-nav-tab]").removeClass("bg-gray-100 text-gray-900").addClass("text-gray-600 hover:bg-gray-50 hover:text-brand-color-900"),e("[data-nav-panel]").removeClass("wpcp-tab-active").addClass("hidden"),t.addClass("wpcp-tab-active").addClass("bg-gray-100 text-gray-900").removeClass("text-gray-600 hover:bg-gray-50 hover:text-brand-color-900"),e("[data-nav-panel='"+n+"']").addClass("wpcp-tab-active").removeClass("hidden"),location.hash.replace("#",""),location.hash=n,window.scrollTo(0,0),window.parent.scroll(0,0)}},'a[data-nav-tab]:not(".disabled")'),location.hash&&location.hash.indexOf("TB_inline")<0?e("[data-nav-tab='"+location.hash.replace("#","")+"']").trigger("click"):e("[data-nav-tab]:first").trigger("click"),e("#wpcp").on({click:function(){var a=e(this),t=e(this).parents("[data-nav-panel]"),n=e(this).next(),o=a.hasClass("wpcp-panel-header-active");o||(t.find(".wpcp-panel-header-opened").hide(),t.find(".wpcp-panel-header-closed").show(),t.find(".wpcp-panel-header-active").removeClass("wpcp-panel-header-active"),t.find(".wpcp-panel-accordion").slideUp(),a.find(".wpcp-panel-header-opened").show(),a.find(".wpcp-panel-header-closed").hide(),a.addClass("wpcp-panel-header-active"),n.slideDown(200),n.get(0).scrollIntoView({block:"start",inline:"start"}))}},".wpcp-panel-header"),e("[data-nav-panel]").each(function(){e(this).find(".wpcp-panel-header:first").trigger("click")}),e(".wpcp-input-checkbox-button, .wpcp-input-checkbox-icon-button").on("click",function(t){var n=e(this).find('input[type="checkbox"]');n.prop("checked",!n.prop("checked")).trigger("change"),a(n.attr("id"),n.prop("checked"),!n.prop("checked"))}),e('.wpcp-input-checkbox-button input[type="checkbox"]').on("change",function(a){var t=e(this).parent(".wpcp-input-checkbox-button"),n=t.children(".wpcp-input-checkbox-button-container"),o=n.children(".wpcp-input-checkbox-button-off"),i=n.children(".wpcp-input-checkbox-button-on"),d=e(this).prop("checked");d?(t.removeClass("bg-gray-200").addClass("bg-brand-color-900"),n.removeClass("translate-x-0").addClass("translate-x-5"),o.removeClass("opacity-100 ease-in duration-200").addClass("opacity-0 ease-out duration-100"),i.removeClass("opacity-0 ease-out duration-100").addClass("opacity-100 ease-in duration-200"),e(t.data("toggle-element")).slideDown()):(t.addClass("bg-gray-200").removeClass("bg-brand-color-900"),n.addClass("translate-x-0").removeClass("translate-x-5"),o.addClass("opacity-100 ease-in duration-200").removeClass("opacity-0 ease-out duration-100"),i.addClass("opacity-0 ease-out duration-100").removeClass("opacity-100 ease-in duration-200"),e(t.data("toggle-element")).slideUp())}).trigger("change"),e('.wpcp-input-checkbox-icon-button input[type="checkbox"]').on("change",function(a){var t=e(this).parent(".wpcp-input-checkbox-icon-button"),n=e(this).prop("checked");n?t.addClass("bg-gray-50 border-brand-color-900").removeClass("bg-white"):t.removeClass("bg-gray-50 border-brand-color-900").addClass("bg-white")}).trigger("change"),e(".wpcp-input-textbox, .wpcp-input-textarea, .wpcp-input-wpeditor, .wpcp-input-hidden").on({focus:function(a){var t=e(this);t.data("old-value",t.val())},change:function(t){var n=e(this);a(n.attr("id"),n.val(),n.data("old-value"))}}),e(".wpcp-input-select").on({focus:function(a){var t=e(this);t.data("old-value",t.val())},change:function(t){var n=e(this);a(n.attr("id"),n.val(),n.data("old-value")),n.trigger("do-toggle")},"do-toggle":function(a){var t=e(this),n=t.find("option").map(function(){return e(this).data("toggle-element")}).get(),o=t.find(":selected").data("toggle-element");n.length&&(e.each(n,function(a,t){e(t).slideUp(0)}),e(o).slideDown())}}).trigger("do-toggle"),e(".wpcp-input-radio").on({focus:function(a){var t=e(this);t.data("old-value",t.val())},change:function(t){var n=e(this);a(n.attr("id"),n.val(),n.data("old-value")),n.trigger("do-toggle")},"do-toggle":function(a){var t=e(this),n=e('input[name="'+t.attr("name")+'"]').map(function(){return e(this).data("toggle-element")}).get(),o=e('input[name="'+t.attr("name")+'"]:checked').data("toggle-element");n.length&&(e.each(n,function(a,t){e(t).slideUp(0)}),e(o).slideDown())}}).trigger("do-toggle"),e(".wpcp-shareon-toggle-button").on("click",function(t){t.stopImmediatePropagation();var n=e(this).next(),o=n.val();"disabled"===o?n.val("enabled"):n.val("disabled"),a(n.attr("id"),n.val(),o),n.trigger("change")}),e(".wpcp-shareon-input").on("change",function(a){"disabled"===e(this).val()?e(this).prev().removeClass("shareon-enabled").addClass("shareon-disabled"):e(this).prev().removeClass("shareon-disabled").addClass("shareon-enabled")}),e(".wpcp-tagify").each(function(){new Tagify(this,{enforceWhitelist:!0,editTags:!1,dropdown:{classname:"wpcp-app",enabled:0,highlightFirst:!0,closeOnSelect:!1,maxItems:20,position:"all"},whitelist:JSON.parse(WPCloudplugin_AdminUI_vars.whitelist),templates:{tag:function(e){return"<tag title='"+e.text+"' contenteditable='false' spellcheck='false' tabIndex='-1'  class="+this.settings.classNames.tag+(e.class?e.class:"")+"><x class='tagify__tag__removeBtn' role='button'></x><div><span class='tagify__tag-type'>"+e.type+"</span><span class='tagify__tag-text'>"+(void 0!==e.text?e.text:e.value)+"</span></div></tag>"},dropdownItem:function(e){return"<div class='tagify__dropdown__item' value='"+e.value+"' role='option'><img onerror='this.style.visibility=\"hidden\"' src='"+e.img+"'><span class='tagify__tag-type'>"+e.type+"</span><span>"+e.text+"</span></div>"},dropdownFooter(e){var a=e.length-this.settings.dropdown.maxItems;return a>0?"<footer class='tagify__dropdown__footer'>"+a+" more items. Refine your search</footer>":""}}})}),tippy(".wpcp_help_tooltip",{allowHTML:!0,interactive:!0}),e(".ddslickbox").each(function(){var a=e(this);a.ddslick({width:"598px",background:"#f4f4f4",onSelected:function(a){var t=e(a.selectedItem).closest(".dd-container").next();t.val()!==a.selectedData.value&&t.val(a.selectedData.value).trigger("change")}})}),e("#wpcp").on({click:function(a){i=e(this).parents(".wpcp-folder-selector"),n(i.find(".wpcp-folder-selector-embed")),window.addEventListener("message",t)}},".wpcp-folder-selector-button, .wpcp-folder-selector-current"),e("#wpcp").on({click:function(a){i=e(this).parents(".wpcp-folder-selector"),i.find(".wpcp-folder-selector-current").val(""),i.find(".wpcp-folder-selector-input-account").val("").trigger("change"),i.find(".wpcp-folder-selector-input-drive").val("").trigger("change"),i.find(".wpcp-folder-selector-input-id").val("").trigger("change"),i.find(".wpcp-folder-selector-input-name ").val("").trigger("change")}},".wpcp-folder-clear-button"),window.showNotification=function(a){var t=e("#wpcp-notification");a?(t.find(".wpcp-notification-success").show(),t.find(".wpcp-notification-failed").hide()):(t.find(".wpcp-notification-success").hide(),t.find(".wpcp-notification-failed").show()),clearTimeout(o),t.fadeIn(),o=window.setTimeout(function(){t.fadeOut()},3e3)},window.hideNotifications=function(){var a=e("#wpcp-notification");a.fadeOut(),clearTimeout(o)},e("#wpcp").on({click:function(a){e(this).parents(".wpcp-dropdown-menu").find(".wpcp-dropdown-menu-content").fadeIn(),a.stopPropagation()}},".wpcp-dropdown-menu button"),e("body").on({click:function(a){e(".wpcp-dropdown-menu-content").hide()}}),e("#wpcp").on({click:function(a){e(e(this).data("dialog-id")).fadeIn()}},".wpcp-modal-open-dialog"),e("#wpcp").on({click:function(a){e(this).parents(".wpcp-dialog").fadeOut()}},".wpcp-dialog-close"),e("#wpcp").on({click:function(a){var t=e(this).parents(".wpcp-dialog");t.fadeOut(null,function(){t.remove()})}},".wpcp-dialog-destroy"),e("#wpcp").on({click:function(a){var t=e(this).parent().parent().find(".wpcp-module");return window.postMessage({slug:"shareonedrive",action:"wpcp-select-entries",entries:[{entry_id:t.attr("data-id"),entry_name:t.find(".wpcp-breadcrumb li:last").text(),account_id:t.attr("data-account-id"),drive_id:t.attr("data-drive-id")}]},window.location.origin),a.stopPropagation(),!0}},".wpcp-dialog-entry-select")})(jQuery);