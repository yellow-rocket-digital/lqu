jQuery(document).ready(function(e){"use strict";function n(n){window.top.postMessage({slug:"shareonedrive",action:"wpcp-shortcode",shortcode:n},window.location.origin);var a=e("form").data("callback");""!==a&&window.parent[a](n)}function a(a){var i=e(".ShareoneDrive.files").attr("data-token"),r=e(".ShareoneDrive[data-token='"+i+"']").attr("data-path"),o=t(".ShareoneDrive[data-token='"+i+"'] input[name='selected-files[]']"),d=e(".ShareoneDrive.files").attr("data-account-id"),l=e(".ShareoneDrive.files").attr("data-drive-id");return 0===o.length&&n(""),e.ajax({type:"POST",url:ShareoneDrive_vars.ajax_url,data:{action:"shareonedrive-embedded",account_id:d,drive_id:l,listtoken:i,lastpath:r,entries:o,editable:"preview"!==a,_ajax_nonce:ShareoneDrive_vars.createlink_nonce},beforeSend:function(){e(".ShareoneDrive .loading").height(e(".ShareoneDrive .ajax-filelist").height()),e(".ShareoneDrive .loading").fadeTo(400,.8),e(".ShareoneDrive .wpcp-dropdown-menu-button").attr("disabled","disabled")},complete:function(){e(".ShareoneDrive .loading").fadeOut(400),e(".ShareoneDrive .wpcp-dropdown-menu-button").removeAttr("disabled")},success:function(a){if(null!==a&&null!==a.links&&a.links.length>0){var t="";e.each(a.links,function(n,a){e.inArray(a.extension,["jpg","jpeg","png","gif"])>-1?t+='<img src="'+a.embeddedlink+'" loading="lazy"/>':t+='<iframe src="'+a.embeddedlink+'" height="480" style="width:100%;" frameborder="0" scrolling="no" class="sod-embedded" allowfullscreen loading="lazy"></iframe>'}),n(t)}},dataType:"json"}),!1}function t(n){var a=e(n+":checked").map(function(){return this.value}).get();return a}e(".wpcp-dropdown-menu-button").on("click",function(n){n.stopPropagation(),a(e(this).data("type"))})});