jQuery(document).ready(function(e){"use strict";function a(a){window.top.postMessage({slug:"shareonedrive",action:"wpcp-shortcode",shortcode:a},window.location.origin);var n=e("form").data("callback");""!==n&&window.parent[n](a)}function n(){var n=e(".ShareoneDrive.files").attr("data-token"),r=e(".ShareoneDrive[data-token='"+n+"']").attr("data-path"),i=t(".ShareoneDrive[data-token='"+n+"'] input[name='selected-files[]']"),o=e(".ShareoneDrive.files").attr("data-account-id"),d=e(".ShareoneDrive.files").attr("data-drive-id");return 0===i.length&&a(""),e.ajax({type:"POST",url:ShareoneDrive_vars.ajax_url,data:{action:"shareonedrive-create-link",account_id:o,drive_id:d,listtoken:n,lastpath:r,entries:i,_ajax_nonce:ShareoneDrive_vars.createlink_nonce},beforeSend:function(){e(".ShareoneDrive .loading").height(e(".ShareoneDrive .ajax-filelist").height()),e(".ShareoneDrive .loading").fadeTo(400,.8),e(".ShareoneDrive .wpcp-dropdown-menu-button").attr("disabled","disabled")},complete:function(){e(".ShareoneDrive .loading").fadeOut(400),e(".ShareoneDrive .wpcp-dropdown-menu-button").removeAttr("disabled")},success:function(n){if(null!==n&&null!==n.links&&n.links.length>0){var t="";e.each(n.links,function(e,a){!1===a.link?t+='<a class="ShareoneDrive-directlink" href="#">Plugin does not have permission to create shared link for: '+a.name+"</a><br/>":t+='<a class="ShareoneDrive-directlink" href="'+a.link.replace("?dl=1","")+'" target="_blank">'+a.name+"</a><br/>"}),a(t)}},dataType:"json"}),!1}function t(a){var n=e(a+":checked").map(function(){return this.value}).get();return n}e(".wpcp-dropdown-menu-content a").on("click",function(a){a.stopPropagation(),n(e(this).data("type"))})});