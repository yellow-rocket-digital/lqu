!function(c){function e(e,t){return t.children().each(function(){c(this).width(c(this).width())}),t}(initAdmin=function(){var e={dom:{colorpickerShow:".option-colorpicker-show"},conditions:{defaultColorpicker:".default-colorpicker",colorpickerPlaceholder:".colorpicker-placeholder"},init:function(){var t=e;c(document).on("change",t.dom.colorpickerShow,function(e){t.handle(c(e.target).closest(".fields").find(t.conditions.defaultColorpicker),"default_color"===c(e.target).val()),t.handle(c(e.target).closest(".fields").find(t.conditions.colorpickerPlaceholder),"placeholder"===c(e.target).val())})},handle:function(e,t){e=c(e);t?e.show():e.hide()}};checkAdminTabs=function(){let e=c(this),t=c("#addon-tabs a"),n=e.attr("id"),o=c("#addon-container > div");t.removeClass("selected"),e.addClass("selected"),o.hide(),c("#addon-container #tab-"+n).show()},avoidBrowserSave=function(){window.onbeforeunload=null},blockRulesShowTo=function(){let e=c(this),t=e.val(),n=c(".yith-wapo-block-rule-show-to-user-roles"),o=c(".yith-wapo-block-rule-show-to-membership");"user_roles"===t?(n.fadeIn(),o.hide()):"membership"===t?(n.hide(),o.fadeIn()):(n.fadeOut(),o.fadeOut())},initMinMaxRules=function(){let e=c("#min-max-rules .field.rule:first-child");var t=e.find("select").val(),n=c("#min-max-rules div.rule.min-max-rule:not(:first)");let o=c("div.enabled-by-addon-enable-min-max #add-min-max-rule");("min"!==t&&"max"!==t||n.length)&&o.hide()},deleteMinMaxrule=function(){let e=c(this),t=c("#min-max-rules div.rule.min-max-rule:first-child select");e.parent().remove(),t.change()},firstMixMaxRule=function(){let e=c(this),t=e.val(),n=e.parents("div.enabled-by-addon-enable-min-max").find("#add-min-max-rule"),o=c("#min-max-rules div.rule.min-max-rule:not(:first)");o.remove(),n.show(),"exa"===t&&n.hide()},addNewMinMaxRule=function(){let e=c(this),t=c("#min-max-rules"),n=c("#min-max-rules .field.rule:first-child"),o=n.find("select").val(),i=e.parents("div.enabled-by-addon-enable-min-max").find("#add-min-max-rule"),a=n.clone(),d=a.find("select"),l=d.find("option");return a.find("span.select2.select2-container").remove(),d.select2({minimumResultsForSearch:-1}),a.find("input[type=number]").val(""),"min"!==o&&"max"!==o||l.each(function(){var e=c(this).val();let t=!1;o===e&&(t=!0),(t="exa"===e?!0:t)&&c(this).remove()}),t.append(a),i.hide(),!1},addConditionalLogic=function(){let e=c("#conditional-rules .field.rule:first-child"),t=e.clone(!1);t.find("input[type=number]").val(""),t.insertBefore("#add-conditional-rule"),t.find(".select2").remove(),t.find(".addon-conditional-rule-addon").select2({width:"200px"}),t.find(".addon-conditional-rule-addon-is").select2({width:"150px"})},removeConditionalLogic=function(){let e=c(this);e.parent().remove()},updateProductNameOnSelect=function(){let e=c(this),t=e.closest(".field").find(".select2-selection__rendered").attr("title"),n=e.closest(".fields").find(".yith-wapo-product-addon-label");n.val(t)},closeAddonPopup=function(e){e.target===this&&closeAddonPopupAction()},closeAddonPopupAction=function(){let e=c("#yith-wapo-addon-overlay"),t=window.location.href;e.fadeOut(),t=t.split("&addon_id"),window.history.pushState("","",t[0])},adjustAddonsIndex=function(){c.each(["addon_enabled","default","show_image"],function(e,t){let n=c('input[name^="options['+t+']" ]');n.each(function(e){c(this).attr("name","options["+t+"]["+e+"]")})})},checkAddonPriceConditions=function(){let e=c(this),t=e.parents(".option-cost"),n=t.find("div.option-price-sale");"multiplied"===e.val()?n.fadeOut():n.fadeIn()},addTimeSlot=function(){let e=c(this).parent(),t=c(this).parent().parent(),n=t.find(".slot:first-child"),o=n.clone();Math.floor(1e5*Math.random());return o.find(".delete-slot").show(),e.before(o),!1},deleteTimeSlot=function(){c(this).parent().remove()},changeDateRuleSelector=function(){var e=c(this).closest(".rule");e.find(".field:not(.what)").hide(),("years"==c(this).val()?e.find(".field.years"):"months"==c(this).val()?e.find(".field.months"):"daysweek"==c(this).val()?e.find(".field.daysweek"):e.find(".field.days")).fadeIn()},deleteDateRule=function(){c(this).parent().remove()},addNewDateRule=function(){let e=c(this).parents(".option").data("index"),t=c(this).parents(".date-rules").find(".date-rules-container .rule").length,n=wp.template("yith-wapo-date-rule-template"),o=c(this).parents(".date-rules").find(".date-rules-container .rule").last();return o.after(n({addon_id:e,option_id:t})),c(document).trigger("yith_fields_init"),!1},c(document).on("click","#yith-wapo-addon-overlay #addon-tabs a",checkAdminTabs),c(document).on("click",".yith-wapo a, .yith-wapo button, .yith-wapo input",avoidBrowserSave),c(document).on("click","#add-min-max-rule a",addNewMinMaxRule),c(document).on("click","#min-max-rules .delete-min-max-rule",deleteMinMaxrule),c(document).on("change","#min-max-rules div.rule.min-max-rule:first-child select",firstMixMaxRule),initMinMaxRules(),c(document).on("change","#yith-wapo-block-rule-show-to",blockRulesShowTo),c(document).on("click","#add-conditional-rule a",addConditionalLogic),c(document).on("click","#conditional-rules .delete-rule",removeConditionalLogic),c(document).on("change",'select[name="options[product][]"]',updateProductNameOnSelect),c(document).on("click","#yith-wapo-addon-overlay",closeAddonPopup),c(document).on("click","#yith-wapo-addon-overlay #close-popup, #yith-wapo-addon-overlay button.cancel",closeAddonPopupAction),c(document).on("click","#add-new-option",adjustAddonsIndex),e.init(),c(document).on("change","#option-price-type",checkAddonPriceConditions),c(document).on("click",".add-time-slot a",addTimeSlot),c(document).on("click",".delete-slot",deleteTimeSlot),c(document).on("change",".date-rules .select_what",changeDateRuleSelector),c(document).on("click",".add-date-rule a",addNewDateRule),c(document).on("click",".date-rules .delete-rule",deleteDateRule)})(),c("#sortable-blocks").on("change",".active .yith-plugin-fw-onoff-container input",function(){var e=c(this).attr("id").replace("yith-wapo-active-block-",""),t=0,t=c(this).is(":checked")?1:0;c.post(ajaxurl,{action:"enable_disable_block",block_id:e,block_vis:t},function(e){console.log("[YITH.LOG] - Block visibility updated")})}),c("#sortable-addons").on("change",".addon-onoff input",function(){var e=c(this).attr("id").replace("yith-wapo-active-addon-",""),t=0,t=c(this).is(":checked")?1:0;c.post(ajaxurl,{action:"enable_disable_addon",addon_id:e,addon_vis:t},function(e){console.log("[YITH.LOG] - Addon visibility updated")})}),c("#sortable-blocks").sortable({containment:"#yith_wapo_panel_blocks .yith-plugin-fw-panel-custom-tab-container",helper:e,revert:!0,axis:"y",update:function(e,t){c("#sortable-blocks").sortable("serialize");t={action:"sortable_blocks",moved_item:c(t.item).data("id"),prev_item:parseFloat(c(t.item).prev().data("priority")),next_item:nextItem=parseFloat(c(t.item).next().data("priority"))};c.post(ajaxurl,t,function(e){var e=e.split("-"),t=e[0],e=parseFloat(e[1]),t=c("#sortable-blocks #block-"+t);t.attr("data-priority",e),t.find("td.priority").html(Math.round(e))})}}),c("#sortable-addons").sortable({containment:"#block-addons-container",revert:!0,axis:"y",update:function(e,t){var n=t.item.data("id"),o=parseFloat(t.item.prev().data("priority")),t=parseFloat(t.item.next().data("priority"));c.post(ajaxurl,{action:"sortable_addons",moved_item:n,prev_item:o,next_item:t},function(e){var e=e.split("-"),t=e[0],e=parseFloat(e[1]);c("#sortable-addons #addon-"+t).attr("data-priority",e)})}}),c("#addon_options").sortable({helper:e,revert:!0,axis:"y",delay:150,update:function(e,t){adjustAddonsIndex()}}),c("ul, li, tbody, tr, td").disableSelection();var t=c("#block-rules #yith-wapo-block-rule-show-in"),n=c(".field-wrap.yith-wapo-block-rule-show-in-products"),o=c(".field-wrap.yith-wapo-block-rule-show-in-categories"),i=t.val(),a=c("#block-rules #yith-wapo-block-rule-exclude-products"),d=c(".field-wrap.yith-wapo-block-rule-exclude-products-products"),l=c(".field-wrap.yith-wapo-block-rule-exclude-products-categories");function r(e){e.is(":checked")?c(".enabled-by-"+e.attr("id")).fadeIn():c(".enabled-by-"+e.attr("id")).fadeOut()}t.change(function(){"products"===(i=c(this).val())?(n.fadeIn(),o.hide()):(n.fadeOut(),o.fadeOut())}),a.change(function(){"yes"==c(this).val()?(d.fadeIn(),"all"==i&&l.fadeIn()):(d.fadeOut(),l.fadeOut())}),c(".yith-wapo").on("change",".enabler input",function(){r(c(this))}),c(".yith-wapo .enabler input").each(function(){r(c(this))}),c(".yith-wapo").on("change","#option-separator-style",function(){"empty_space"==c(this).val()?c(".field-wrap.option-separator-color").fadeOut():c(".field-wrap.option-separator-color").fadeIn()}),c(".yith-wapo").on("change","#addon-custom-style",function(){!c(this).is(":checked")&&c("#addon-image-equal-height").is(":checked")&&c(".addon-image-equal-height .yith-plugin-fw-onoff").click()}),c("#tab-options-list").on("click",".option .title",function(e){let t=jQuery(e.target);t.hasClass("selected-by-default-chbx")||((e=c(this).parent().find(".fields")).toggle(),e.is(":visible")?c(this).parent().removeClass("close").addClass("open"):c(this).parent().removeClass("open").addClass("close"))}),c("#add-new-option").click(function(){var e=c(this).parent().find(".option").length,e=(c(".yith-plugin-fw-upload-container button").off(),wp.template("new-option-"+e));c("#add-new-option").before(e()),c("body").trigger("yith_fields_init")}),c("#tab-options-list").on("change",".option-price-method",function(){var e=c(this).parent().parent().parent().parent();"free"!=c(this).val()&&"product"!=c(this).val()&&"value_x_product"!=c(this).val()?(e.find(".option-cost").fadeIn(),"increase"==c(this).val()?(e.find(".option-cost .option-price-method-increase").fadeIn(),e.find(".option-cost .option-price-method-decrease").fadeOut()):(e.find(".option-cost .option-price-method-increase").fadeOut(),e.find(".option-cost .option-price-method-decrease").fadeIn())):e.find(".option-cost").fadeOut()}),c("#tab-options-list").on("change",".option-selectable-dates",function(){var e=c(this).parent().parent().parent().parent();"days"==c(this).val()?(e.find(".option-selectable-days-ranges").fadeIn(),e.find(".option-selectable-date-ranges").hide()):"date"==c(this).val()?(e.find(".option-selectable-days-ranges").hide(),e.find(".option-selectable-date-ranges").fadeIn()):(e.find(".option-selectable-days-ranges").hide(),e.find(".option-selectable-date-ranges").hide())}),c(document).on("click","#addon-container .yith-plugin-fw__action-button--delete-action",function(){return c(this).parents(".option").remove(),adjustAddonsIndex(),!1}),c("#tab-options-list").on("change",".color-show-as select",function(){var e=c(this).parent().parent().parent().parent().parent();"double"==c(this).val()?(e.find(".color").fadeIn(),e.find(".color_b").fadeIn(),e.find(".color_image").hide()):"image"==c(this).val()?(e.find(".color").hide(),e.find(".color_b").hide(),e.find(".color_image").fadeIn()):(e.find(".color").fadeIn(),e.find(".color_b").hide(),e.find(".color_image").hide())}),c("#tab-options-list").on("click",".option .title",function(){c(this).parent().find(".color-show-as select").change()}),c("#tab-options-list").find(".color-show-as select").change(),c(".yith-wapo").on("change",".option-date-default",function(){var e=c(this).parent().parent().parent().parent();"specific"==c(this).val()?(e.find(".option-date-default-day").fadeIn(),e.find(".option-date-default-interval").hide()):"interval"==c(this).val()?(e.find(".option-date-default-day").hide(),e.find(".option-date-default-interval").fadeIn()):(e.find(".option-date-default-day").fadeOut(),e.find(".option-date-default-interval").fadeOut())}),c(document).on("select2:open",function(e){c(".select2-results").closest(".select2-container").addClass("yith-addons-select2-container")})}(jQuery);