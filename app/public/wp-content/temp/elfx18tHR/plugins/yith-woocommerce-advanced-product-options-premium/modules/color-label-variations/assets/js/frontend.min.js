!function(t,a,e){if("undefined"==typeof yith_wapo_color_label_attr)return!1;var i=function(a,e,i){var o=!1,l=a.data("product_variations"),n=a.find(".variations select"),r=[];t.each(n,function(){var a=t(this).data("attribute_name")||t(this).attr("name");i===a?r[a]=e:r[a]=t(this).val()});for(var s=0;s<l.length;s++){var c=l[s];if(o)break;for(var d in o=c,c.attributes)if(c.attributes.hasOwnProperty(d)){var h=c.attributes[d];h!==r[d]&&""!==h&&(o=!1)}}return o},o=function(t,a){this.$form=t,this.$attr=JSON.parse(yith_wapo_color_label_attr.attributes),this.$select=this.$form.find(".variations select"),this.$use_ajax=!1===this.$form.data("product_variations"),this.$xhr=null,this.variations_gallery=[],void 0===this.$attr&&(this.$attr=[]),t.on("yith_wccl_form_initialized",{obj:this},this.init),this.$select.each(function(){this.setAttribute("data-default_value",this.value)}),this.resetForm(this),this.$form.hasClass("initialized")||this.$form.addClass("initialized").fadeIn().trigger("yith_wccl_form_initialized")};o.prototype.styleOption=function(a,e,i,o){"colorpicker"===i?1===(o=o.split(",")).length?e.append(t("<span/>",{class:"yith_wccl_value",css:{background:o}})):(e.append(t('<span class="yith_wccl_value"><span class="yith-wccl-bicolor"/></span>')),e.find(".yith-wccl-bicolor").css({"border-bottom-color":o[0],"border-left-color":o[1]})):"image"===i?e.append(t("<img/>",{class:"yith_wccl_value",src:o,alt:i})):"label"===i&&e.append(t("<span/>",{class:"yith_wccl_value",text:o}))},o.prototype.addTooltip=function(a,e,i,o,l){if(yith_wapo_color_label_attr.tooltip&&void 0!==e&&e&&!i.find(".yith_wccl_tooltip").length){var n=t('<span class="yith_wccl_tooltip"></span>'),r=yith_wapo_color_label_attr.tooltip_pos+" "+yith_wapo_color_label_attr.tooltip_ani;"image"===o&&(e=e.toString().replace("{show_image}",'<img src="'+l+'" />')),n.addClass(r),i.append(n.html("<span>"+e+"</span>"))}},o.prototype.handleSelect=function(a){var e=a.data.obj;e.$select.each(function(){var a,o=t(this),l=e.$attr[this.name],n=decodeURIComponent(this.name),r=o.parent().find(".select_box"),s=[];(a=o.closest(".select-wrapper")).length||(a=o.closest("td")).length||(a=o.parent()),void 0===l&&(l=e.$attr[n]),yith_wapo_color_label_attr.description&&!e.$form.find(".description_"+n).length&&void 0!==l&&l.descr&&(o.closest("tr").length?o.closest("tr").after('<tr class="description_'+n+'"><td colspan="2">'+l.descr+"</td></tr>"):a.append('<p class="description_'+n+'">'+l.descr+"</p>"));var c=void 0!==l?l.type:o.data("type"),d=void 0!==l&&l.terms;void 0!==l&&l.terms&&void 0!==c&&c&&(o.addClass("yith_wccl_custom").hide(),a.addClass("yith_wccl_is_custom"),r.length&&yith_wapo_color_label_attr.grey_out||(r.remove(),r=t("<div />",{class:"select_box_"+c+" select_box "+o.attr("name")}).insertAfter(o)),o.find("option").each(function(){var a=t(this).val();if(d&&void 0!==d[a]||void 0!==t(this).data("value")&&""!==t(this).data("value")){s.push(a);var l=t(this),n="select_option_"+c+" select_option",h=d&&void 0!==d[a]?d[a].value:t(this).data("value"),f=d&&void 0!==d[a]?d[a].tooltip:t(this).data("tooltip"),p=r.find('[data-value="'+a+'"]');p.length||((a===o.val()||a===o.attr("data-default_value"))&&(n+=" selected"),(p=t("<div/>",{class:n,"data-value":a}).appendTo(r)).off("click").on("click",function(a){var n=t(this).hasClass("inactive"),r=t(this).hasClass("selected");if(n){var s=o.data("attribute_name")||o.attr("name");i(e.$form,t(this).data("value"),s)?o.val("").change():e.resetForm(e)}r?o.val("").change():o.val(l.val()).change(),t(this).toggleClass("selected"),t(this).siblings().removeClass("selected")}),e.styleOption(e,p,c,h),e.addTooltip(e,f,p,c,h))}}),r.children().each(function(){var a=t(this).data("value")+"";-1===t.inArray(a,s)?t(this).addClass("inactive"):t(this).removeClass("inactive")}),e.$form.trigger("yith_wccl_select_initialized",[o,l]))})},o.prototype.setDefaultValue=function(a){var e=a.data.obj;e.$select.each(function(){t(this).val(t(this).attr("data-default_value"))}),e.$select.first().change()},o.prototype.handleCheckVariations=function(t,a,e){var i=t.data.obj;if(!e){if(i.$found&&(t.data.obj.$found=!1,!i.$use_ajax))return;i.$changed&&(t.data.obj.$changed=!1)}},o.prototype.handleFoundVariation=function(t,a){var e=t.data.obj;e.$use_ajax?e.handleSelect(t):e.$select.last().trigger("focusin")},o.prototype.handleVariationGallery=function(a,e){var i,o=a.data.obj,l=t(yith_wapo_color_label_attr.single_gallery_selector);if(l.length)null!==o.$xhr&&o.$xhr.abort(),(i=void 0!==e?e.variation_id:o.$form.find('input[name="product_id"]').val())&&void 0!==i&&(void 0!==o.variations_gallery[i]?o.loadVariationGallery(o.variations_gallery[i],l,e):o.$xhr=t.ajax({url:yith_wapo_color_label_attr.ajaxurl.toString().replace("%%endpoint%%",yith_wapo_color_label_attr.actionVariationGallery),data:{action:yith_wapo_color_label_attr.actionVariationGallery,id:i,context:"frontend"},type:"POST",dataType:"html",beforeSend:function(){l.addClass("loading-gallery")},success:function(t){l.removeClass("loading-gallery"),o.$xhr=null,t&&(o.variations_gallery[i]=t,o.loadVariationGallery(t,l,e))}}))},o.prototype.loadVariationGallery=function(a,i,o){i.replaceWith(a).fadeIn(),"undefined"!=typeof wc_single_product_params&&t(yith_wapo_color_label_attr.single_gallery_selector).wc_product_gallery(wc_single_product_params),this.$form.wc_variations_image_update(o),t(e).trigger("yith_wccl_product_gallery_loaded")},o.prototype.resetForm=function(t){t.$form.find("div.select_option").removeClass("selected inactive"),t.$select.val("").change(),t.$form.trigger("reset_data","yith_wccl")},o.prototype.onReset=function(t){t.data.obj.$form.find(".select_option.selected").removeClass("selected inactive")},o.prototype.init=function(a){var e=a.data.obj;e.$form.on("click.wc-variation-form",".reset_variations",{obj:e},e.onReset),e.$form.on("woocommerce_update_variation_values",{obj:e},e.handleSelect),e.$form.on("check_variations",{obj:e},e.handleCheckVariations),e.$form.on("found_variation",{obj:e},e.handleFoundVariation),yith_wapo_color_label_attr.enable_handle_variation_gallery&&(e.$form.on("found_variation",{obj:e},e.handleVariationGallery),e.$form.on("reset_image",{obj:e},e.handleVariationGallery)),e.handleSelect(a),e.$select.each(function(){var a=t(this).attr("data-default_value");t(this).removeAttr("data-default_value"),t(this).val(a)})},t.yith_wccl=function(a){forms=t(".variations_form.cart:not(.initialized), .owl-item.cloned .variations_form, form.cart.ywcp_form_loaded"),void 0===a&&(a=[]),forms.each(function(){new o(t(this),a)})},t(e).on("yith_wccl_product_gallery_loaded",function(){if("undefined"!=typeof mkdf&&"function"==typeof mkdf.modules.common.mkdfPrettyPhoto){var a=t(".mkdf-woo-single-page.mkdf-woo-single-has-pretty-photo .images .woocommerce-product-gallery__image");a.length&&(a.children("a").attr("data-rel","prettyPhoto[woo_single_pretty_photo]"),mkdf.modules.common.mkdfPrettyPhoto())}"undefined"!=typeof Flatsome&&(Flatsome.attach(t(".product-gallery")),t(".zoom-button").click(function(a){a.preventDefault(),t(".product-gallery-slider").find(".is-selected a").click()}))}),t(e).ready(function(){t.yith_wccl()})}(jQuery,window,document);
